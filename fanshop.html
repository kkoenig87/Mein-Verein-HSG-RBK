<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fanshop - HSG R√º/Bau/K√∂</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    :root{
      --brand:#ff00a0;
      --brand-dark:#cc0080;
      --card-bg:#ffffff;
      --muted:#666;
    }
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:#f7f7f8; color:#111;}
    header{background:var(--brand); color:#fff; padding:1rem; text-align:center; position:relative;}
    header h1{margin:0; font-size:1.25rem;}
    .menu-toggle{position:absolute; right:1rem; top:0.9rem; background:none;border:0;color:#fff;font-size:1.6rem;cursor:pointer}

    main{max-width:1100px;margin:1rem auto;padding:0 1rem;}
    .products{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:1rem;}
    .product{background:var(--card-bg); border-radius:10px; padding:0.8rem; box-shadow:0 6px 18px rgba(0,0,0,0.06); text-align:center;}
    .product h3{margin:0.4rem 0;color:var(--brand)}
    .product p{margin:0.25rem 0;color:var(--muted)}
    .product .price{font-weight:700;margin:0.5rem 0}
    .product .images{display:flex; gap:0.5rem; justify-content:center; flex-wrap:wrap; margin-bottom:0.5rem;}
    .product .images img{max-width:120px;border-radius:8px;cursor:pointer; box-shadow:0 3px 8px rgba(0,0,0,0.12); transition:transform .18s}
    .product .images img:hover{transform:scale(1.03)}

    .controls{display:flex; gap:0.5rem; justify-content:center; align-items:center; margin-top:0.5rem; flex-wrap:wrap;}
    select,input[type="number"]{padding:0.45rem;border-radius:6px;border:1px solid #ddd}
    button.btn{background:var(--brand); color:#fff; border:0; padding:0.5rem 0.8rem; border-radius:8px; cursor:pointer; font-weight:700}
    button.btn:hover{background:var(--brand-dark)}

    /* Cart & order area */
    .cart-wrap{margin-top:1.25rem; display:grid; grid-template-columns:1fr 360px; gap:1rem;}
    @media(max-width:880px){ .cart-wrap{grid-template-columns:1fr} }

    .cart{background:var(--card-bg); padding:1rem; border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,0.06);}
    .cart h2{margin:0 0 0.5rem 0; color:var(--brand)}
    .cart-list{list-style:none;padding:0;margin:0 0 0.5rem 0; max-height:420px; overflow:auto;}
    .cart-item{display:flex; gap:0.5rem; align-items:center; justify-content:space-between; padding:0.5rem 0; border-bottom:1px dashed #eee}
    .cart-item .left{flex:1}
    .cart-item small{color:var(--muted)}
    .cart-item .actions{display:flex; gap:0.4rem; align-items:center}

    .summary{background:#fafafa;padding:0.8rem;border-radius:8px;margin-top:0.6rem}
    .summary .line{display:flex;justify-content:space-between;padding:0.25rem 0}
    .summary strong{font-size:1.05rem}

    /* Order form */
    form.order{background:var(--card-bg); padding:1rem; border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,0.06);}
    form.order label{display:block;font-weight:600;margin-top:0.6rem}
    form.order input, form.order textarea, form.order select{width:100%;padding:0.5rem;border-radius:6px;border:1px solid #ddd;margin-top:0.25rem}
    form.order button{margin-top:0.8rem}

    /* Lightbox */
    .lightbox{display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:2000; justify-content:center; align-items:center}
    .lightbox img{max-width:94%; max-height:92%; border-radius:10px; box-shadow:0 8px 30px rgba(0,0,0,0.6)}
    .lightbox:active{cursor:zoom-out}

    /* confirmation toast */
    .toast{position:fixed; left:50%; transform:translateX(-50%); bottom:1.25rem; background:#1b8f3a;color:#fff;padding:0.55rem 0.9rem;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.18); display:none; z-index:3000; font-weight:700}

    /* small helpers */
    .muted{color:var(--muted);font-size:0.9rem}
    .small{font-size:0.9rem;color:var(--muted)}
    .remove{background:#e74c3c;color:#fff;border:0;padding:0.35rem 0.5rem;border-radius:6px;cursor:pointer}
  </style>
</head>
<body>
  <header>
    <button class="menu-toggle" aria-label="Menu">‚ò∞</button>
    <h1>HSG R√º/Bau/K√∂ ‚Äî Fanshop</h1>
  </header>

  <main>
    <!-- PRODUCTS -->
    <section>
      <h2 class="small">Unsere Fanartikel</h2>
      <div class="products" id="products">
        <!-- Product 1: Fantrikot -->
        <article class="product" data-sku="trikot">
          <div class="images">
            <img src="img/Fantrikot1.png" alt="Fantrikot Vorderseite" data-full="img/Fantrikot1.png">
            <img src="img/Fantrikot2.png" alt="Fantrikot R√ºckseite" data-full="img/Fantrikot2.png">
          </div>
          <h3>HSG Fantrikot</h3>
          <p class="small">Original in Vereinsfarben</p>
          <p class="price"><strong>24,90 ‚Ç¨</strong></p>

          <div class="controls">
            <select id="size-trikot">
              <option value="S">Gr√∂√üe S</option>
              <option value="M">Gr√∂√üe M</option>
              <option value="L">Gr√∂√üe L</option>
              <option value="XL">Gr√∂√üe XL</option>
            </select>
            <input type="number" id="qty-trikot" min="1" value="1" style="width:78px">
            <button class="btn" type="button" onclick="addToCartFromUI('trikot','HSG Fantrikot',24.90,'size-trikot','qty-trikot')">In den Warenkorb</button>
          </div>
        </article>

        <!-- Product 2: Fanshirt -->
        <article class="product" data-sku="fanshirt">
          <div class="images">
            <img src="img/Fanshirt1.png" alt="Fanshirt vorne" data-full="img/Fanshirt1.png">
            <img src="img/Fanshirt2.png" alt="Fanshirt hinten" data-full="img/Fanshirt2.png">
          </div>
          <h3>HSG Fanshirt</h3>
          <p class="small">Klassisches Shirt mit Vereinslogo</p>
          <p class="price"><strong>15,90 ‚Ç¨</strong></p>

          <div class="controls">
            <select id="size-shirt">
              <option value="S">Gr√∂√üe S</option>
              <option value="M">Gr√∂√üe M</option>
              <option value="L">Gr√∂√üe L</option>
              <option value="XL">Gr√∂√üe XL</option>
            </select>
            <input type="number" id="qty-shirt" min="1" value="1" style="width:78px">
            <button class="btn" type="button" onclick="addToCartFromUI('fanshirt','HSG Fanshirt',15.90,'size-shirt','qty-shirt')">In den Warenkorb</button>
          </div>
        </article>

        <!-- Product 3: Sweater -->
        <article class="product" data-sku="sweater">
          <div class="images">
            <img src="img/Sweater1.png" alt="Sweater vorne" data-full="img/Sweater1.png">
            <img src="img/Sweater2.png" alt="Sweater hinten" data-full="img/Sweater2.png">
          </div>
          <h3>HSG Sweater</h3>
          <p class="small">Warmer Sweater mit Logo</p>
          <p class="price"><strong>35,90 ‚Ç¨</strong></p>

          <div class="controls">
            <select id="size-sweater">
              <option value="S">Gr√∂√üe S</option>
              <option value="M">Gr√∂√üe M</option>
              <option value="L">Gr√∂√üe L</option>
              <option value="XL">Gr√∂√üe XL</option>
            </select>
            <input type="number" id="qty-sweater" min="1" value="1" style="width:78px">
            <button class="btn" type="button" onclick="addToCartFromUI('sweater','HSG Sweater',35.90,'size-sweater','qty-sweater')">In den Warenkorb</button>
          </div>
        </article>

        <!-- Product 4: G√ºrteltasche -->
        <article class="product" data-sku="guerteltasche">
          <div class="images">
            <img src="img/Guerteltasche.png" alt="Kempa G√ºrteltasche" data-full="img/Guerteltasche.png">
          </div>
          <h3>Kempa G√ºrteltasche</h3>
          <p class="small">Praktische Bauchtasche im HSG-Style</p>
          <p class="price"><strong>19,90 ‚Ç¨</strong></p>

          <div class="controls">
            <input type="number" id="qty-guerteltasche" min="1" value="1" style="width:78px">
            <button class="btn" type="button" onclick="addToCartFromUI('guerteltasche','Kempa G√ºrteltasche',19.90,null,'qty-guerteltasche')">In den Warenkorb</button>
          </div>
        </article>
      </div>
    </section>

    <!-- CART + ORDER -->
    <section class="cart-wrap">
      <div class="cart">
        <h2>üõí Dein Warenkorb</h2>
        <ul id="cart-list" class="cart-list"></ul>

        <div class="summary" id="summary">
          <div class="line"><span class="small">Zwischensumme</span><span id="subtotal">0,00 ‚Ç¨</span></div>
          <div class="line"><span class="small">Versand</span><span id="shipping-line">0,00 ‚Ç¨</span></div>
          <div class="line"><strong>Gesamt</strong><strong id="grand-total">0,00 ‚Ç¨</strong></div>
        </div>

        <div style="margin-top:0.6rem">
          <label class="small">Versandoption:</label>
          <select id="shipping-option" aria-label="Versand">
            <option value="pickup">Abholung (kostenlos)</option>
            <option value="dhl">Versand per DHL (+7,90 ‚Ç¨)</option>
          </select>
        </div>
      </div>

      <form class="order" id="order-form" onsubmit="submitOrder(event)">
        <h3>Bestelldaten</h3>
        <label for="cust-name">Name *</label>
        <input id="cust-name" required>
        <label for="cust-address">Adresse *</label>
        <textarea id="cust-address" rows="3" required></textarea>
        <label for="cust-phone">Telefon *</label>
        <input id="cust-phone" required>
        <label for="cust-email">E-Mail *</label>
        <input id="cust-email" type="email" required>
        <small class="muted">Die Bestellung wird per E-Mail an kaiuwe.koenig@web.de gesendet.</small>
        <button class="btn" type="submit">Bestellung abschicken</button>
      </form>
    </section>

    <!-- Lightbox (hidden) -->
    <div id="lightbox" class="lightbox" onclick="closeLightbox()"><img id="lightbox-img" src="" alt="Zoom"></div>

    <!-- Toast confirmation -->
    <div id="toast" class="toast">Artikel in den Warenkorb gelegt</div>
  </main>

  <script>
    // --- Utility: format number to German price (comma) ---
    function formatPriceEuro(value){
      return value.toFixed(2).replace('.',',') + ' ‚Ç¨';
    }

    // --- Cart management (localStorage persistence) ---
    const STORAGE_KEY = 'hsg_fanshop_cart_v1';
    let cart = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

    // Shipping cost
    const SHIPPING_COST = 7.90;

    // initial render
    document.addEventListener('DOMContentLoaded', () => {
      renderCart();
      attachImageLightbox();
      document.getElementById('shipping-option').addEventListener('change', renderCart);
    });

    // Add to cart helper reading UI selectors by id
    function addToCartFromUI(sku,name,price,sizeSelectId,qtyInputId){
      const size = sizeSelectId ? document.getElementById(sizeSelectId).value : null;
      const qty = qtyInputId ? Math.max(1, parseInt(document.getElementById(qtyInputId).value) || 1) : 1;
      addToCart(sku,name,price,size,qty);
    }

    function addToCart(sku,name,price,size,quantity){
      // If same product+size exists, increment quantity
      const existing = cart.find(i => i.sku===sku && (i.size||'') === (size||''));
      if(existing){
        existing.quantity += quantity;
      } else {
        cart.push({ sku, name, price: Number(price), size: size||null, quantity: Number(quantity) });
      }
      saveCart();
      renderCart();
      showToast(`${name} wurde in den Warenkorb gelegt`);
    }

    function saveCart(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(cart));
    }

    function removeItem(index){
      cart.splice(index,1);
      saveCart();
      renderCart();
    }

    function changeQty(index, delta){
      cart[index].quantity = Math.max(1, cart[index].quantity + delta);
      saveCart();
      renderCart();
    }

    function setQty(index, val){
      cart[index].quantity = Math.max(1, parseInt(val) || 1);
      saveCart();
      renderCart();
    }

    // Render cart UI
    function renderCart(){
      const list = document.getElementById('cart-list');
      list.innerHTML = '';
      let subtotal = 0;
      cart.forEach((item, idx) => {
        subtotal += item.price * item.quantity;
        const li = document.createElement('li');
        li.className = 'cart-item';
        li.innerHTML = `
          <div class="left">
            <div style="font-weight:700">${item.name}${item.size ? ' ‚Äî ' + item.size : ''}</div>
            <small>${formatPriceEuro(item.price)} x ${item.quantity} = ${formatPriceEuro(item.price * item.quantity)}</small>
          </div>
          <div class="actions">
            <button class="remove" onclick="removeItem(${idx})" title="Entfernen">‚úñ</button>
            <button class="btn" onclick="changeQty(${idx},-1)" title="Menge verringern">‚àí</button>
            <input style="width:56px;padding:6px;border-radius:6px;border:1px solid #ddd;text-align:center" value="${item.quantity}" oninput="setQty(${idx}, this.value)" />
            <button class="btn" onclick="changeQty(${idx},1)" title="Menge erh√∂hen">+</button>
          </div>`;
        list.appendChild(li);
      });

      const shippingOption = document.getElementById('shipping-option').value;
      const shippingLine = shippingOption === 'dhl' && cart.length>0 ? SHIPPING_COST : 0;
      const grand = subtotal + shippingLine;

      document.getElementById('subtotal').textContent = formatPriceEuro(subtotal);
      document.getElementById('shipping-line').textContent = formatPriceEuro(shippingLine);
      document.getElementById('grand-total').textContent = formatPriceEuro(grand);
    }

    // --- Checkout (mailto) ---
    function submitOrder(e){
      e.preventDefault();
      if(cart.length === 0){
        alert('Dein Warenkorb ist leer. Bitte lege Artikel in den Warenkorb.');
        return;
      }
      const name = document.getElementById('cust-name').value || document.getElementById('cust-name')?.value;
      const address = document.getElementById('cust-address').value;
      const phone = document.getElementById('cust-phone').value;
      const email = document.getElementById('cust-email').value;
      const shippingOption = document.getElementById('shipping-option').value;
      // build text
      let lines = [];
      cart.forEach(it => {
        lines.push(`${it.quantity}x ${it.name}${it.size? ' ('+it.size+')' : ''} ‚Äî ${formatPriceEuro(it.price * it.quantity)}`);
      });
      const subtotal = cart.reduce((s,i)=>s + i.price * i.quantity,0);
      const shippingLine = shippingOption==='dhl' ? SHIPPING_COST : 0;
      const grand = subtotal + shippingLine;
      let body = `Bestellung Fanshop HSG R√º/Bau/K√∂\n\nArtikel:\n${lines.join('\n')}\n\nZwischensumme: ${formatPriceEuro(subtotal)}\nVersand: ${formatPriceEuro(shippingLine)}\nGesamt: ${formatPriceEuro(grand)}\n\nKundendaten:\nName: ${name}\nAdresse: ${address}\nTelefon: ${phone}\nE-Mail: ${email}\nVersandoption: ${shippingOption === 'dhl' ? 'DHL (7,90 ‚Ç¨)' : 'Abholung'}`;
      const mailto = `mailto:kaiuwe.koenig@web.de?subject=Fanshop-Bestellung&body=${encodeURIComponent(body)}`;
      // open mail client
      window.location.href = mailto;
    }

    // --- Lightbox ---
    function attachImageLightbox(){
      document.querySelectorAll('.product img').forEach(img=>{
        img.addEventListener('click', ()=> {
          const src = img.getAttribute('data-full') || img.src;
          document.getElementById('lightbox-img').src = src;
          document.getElementById('lightbox').style.display = 'flex';
        });
      });
    }
    function closeLightbox(){
      document.getElementById('lightbox').style.display = 'none';
      document.getElementById('lightbox-img').src = '';
    }

    // --- Toast confirmation ---
    function showToast(msg){
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.style.display = 'block';
      clearTimeout(t._hide);
      t._hide = setTimeout(()=> t.style.display = 'none', 2200);
    }
  </script>
</body>
</html>
