<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fanshop - HSG RÃ¼/Bau/KÃ¶</title>
  <style>
    :root{
      --brand:#ff00a0;
      --brand-dark:#cc0080;
      --bg:#f7f7f8;
      --card:#fff;
      --muted:#666;
      --success:#1b8f3a;
    }
    body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:0;background:var(--bg);color:#111}
    header{background:var(--brand);color:#fff;padding:0.9rem 1rem;text-align:center}
    header h1{margin:0;font-size:1.05rem;font-weight:700}
    main{max-width:1100px;margin:1rem auto;padding:0 1rem}
    .products{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem}
    .product{background:var(--card);border-radius:10px;padding:0.8rem;box-shadow:0 6px 18px rgba(0,0,0,0.06);text-align:center}
    .product h3{color:var(--brand)}
    .price{font-weight:700;margin:0.4rem 0}
    select,input[type=number]{padding:0.45rem;border-radius:6px;border:1px solid #ddd}
    button.btn{background:var(--brand);color:#fff;border:0;padding:0.5rem 0.9rem;border-radius:8px;cursor:pointer;font-weight:700}
    button.btn:hover{background:var(--brand-dark)}
    .cart-wrap{margin-top:1.25rem;display:grid;grid-template-columns:1fr 360px;gap:1rem}
    @media(max-width:880px){ .cart-wrap{grid-template-columns:1fr} }
    .cart,.order{background:var(--card);padding:1rem;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    .summary{background:#fafafa;padding:0.8rem;border-radius:8px;margin-top:0.6rem}
    .summary .line{display:flex;justify-content:space-between;padding:0.25rem 0}
    .summary strong{font-size:1.05rem}
    .cart-list{list-style:none;padding:0;margin:0}
    .cart-item{border-bottom:1px dashed #eee;padding:0.4rem 0}
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:1.25rem;background:var(--success);color:#fff;padding:0.5rem 0.9rem;border-radius:8px;display:none}
  </style>
</head>
<body>
  <header><h1>HSG RÃ¼/Bau/KÃ¶ â€” Fanshop</h1></header>

  <main>
    <!-- Produkte -->
    <section>
      <h2>Unsere Fanartikel</h2>
      <div class="products">
        <div class="product">
          <img src="img/Fantrikot1.png" alt="Fantrikot" style="max-width:140px">
          <h3>HSG Fantrikot</h3>
          <p class="price">24,90 â‚¬</p>
          <select id="size-trikot">
            <option>S</option><option>M</option><option>L</option><option>XL</option>
          </select>
          <input type="number" id="qty-trikot" value="1" min="1" style="width:60px">
          <button class="btn" onclick="addToCart('trikot','HSG Fantrikot',24.90,document.getElementById('size-trikot').value,document.getElementById('qty-trikot').value)">In den Warenkorb</button>
        </div>
      </div>
    </section>

    <!-- Warenkorb -->
    <section class="cart-wrap">
      <div class="cart">
        <h2>ðŸ›’ Dein Warenkorb</h2>
        <ul id="cart-list" class="cart-list"></ul>

        <div>
          <label>Versandoption:</label>
          <select id="shipping-option" onchange="renderCart()">
            <option value="pickup">Abholung (0,00 â‚¬)</option>
            <option value="dhl">DHL (7,90 â‚¬)</option>
            <option value="hermes">Hermes (6,50 â‚¬)</option>
            <option value="express">Express (12,90 â‚¬)</option>
          </select>
        </div>

        <div>
          <label>Rabattcode:</label>
          <input id="discount-code" placeholder="Code eingeben">
          <button class="btn" type="button" onclick="applyDiscountCode()">EinlÃ¶sen</button>
        </div>

        <div class="summary">
          <div class="line"><span>Zwischensumme</span><span id="subtotal">0,00 â‚¬</span></div>
          <div class="line"><span>Versand</span><span id="shipping">0,00 â‚¬</span></div>
          <div class="line"><span>Rabatt</span><span id="discount">0,00 â‚¬</span></div>
          <div class="line"><strong>Gesamt</strong><strong id="total">0,00 â‚¬</strong></div>
        </div>
      </div>

      <form class="order" onsubmit="submitOrder(event)">
        <h3>Bestelldaten</h3>
        <label>Name</label><input id="cust-name" required>
        <label>Adresse</label><textarea id="cust-address" required></textarea>
        <label>Telefon</label><input id="cust-phone" required>
        <label>E-Mail</label><input id="cust-email" type="email" required>
        <button class="btn">Bestellung abschicken</button>
      </form>
    </section>

    <div id="toast" class="toast"></div>
    <!-- Admin-Button -->
    <button onclick="addDiscountCode('percent',15)" style="position:fixed;bottom:10px;right:10px;opacity:0.2">+ Rabattcode</button>
  </main>

  <script>
    const STORAGE_KEY = "fanshop_cart";
    let cart = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

    // Rabattcodes
    let discountCodes = {
      "WELCOME-10": { type: "percent", value: 10 },
      "FREI-5EUR": { type: "amount", value: 5 }
    };
    let appliedDiscount = null;

    function formatPrice(v){return v.toFixed(2).replace(".",",")+" â‚¬";}

    function addToCart(sku,name,price,size,qty){
      qty = parseInt(qty)||1;
      const ex = cart.find(i=>i.sku===sku && i.size===size);
      if(ex) ex.qty += qty;
      else cart.push({sku,name,price,size,qty});
      saveCart();renderCart();showToast(name+" hinzugefÃ¼gt!");
    }
    function saveCart(){localStorage.setItem(STORAGE_KEY,JSON.stringify(cart));}
    function removeItem(i){cart.splice(i,1);saveCart();renderCart();}

    function renderCart(){
      let html="", subtotal=0;
      cart.forEach((it,i)=>{
        subtotal += it.price*it.qty;
        html+=`<li class="cart-item">${it.name}${it.size?" ("+it.size+")":""} â€” ${it.qty}x ${formatPrice(it.price)} 
        <button onclick="removeItem(${i})">âœ–</button></li>`;
      });
      document.getElementById("cart-list").innerHTML=html;
      document.getElementById("subtotal").textContent=formatPrice(subtotal);

      // Versand
      const shipOpt=document.getElementById("shipping-option").value;
      let shipping=0;
      if(shipOpt==="dhl") shipping=7.9;
      if(shipOpt==="hermes") shipping=6.5;
      if(shipOpt==="express") shipping=12.9;
      document.getElementById("shipping").textContent=formatPrice(shipping);

      // Rabatt
      let discount=0;
      if(appliedDiscount){
        if(appliedDiscount.type==="percent") discount=subtotal*appliedDiscount.value/100;
        if(appliedDiscount.type==="amount") discount=appliedDiscount.value;
      }
      document.getElementById("discount").textContent="-"+formatPrice(discount);

      const total=subtotal+shipping-discount;
      document.getElementById("total").textContent=formatPrice(total>0?total:0);
    }

    function applyDiscountCode(){
      const code=document.getElementById("discount-code").value.trim().toUpperCase();
      if(discountCodes[code]){
        appliedDiscount=discountCodes[code];
        showToast("Rabattcode akzeptiert!");
      } else {
        appliedDiscount=null;
        showToast("UngÃ¼ltiger Code");
      }
      renderCart();
    }

    function generateDiscountCode(length=12){
      const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let code="";
      for(let i=0;i<length;i++){ if(i>0&&i%4===0) code+="-"; code+=chars.charAt(Math.floor(Math.random()*chars.length));}
      return code;
    }
    function addDiscountCode(type="percent",value=10){
      const newCode=generateDiscountCode();
      discountCodes[newCode]={type,value};
      alert("Neuer Rabattcode:\n"+newCode+"\n("+type+" "+value+")");
      return newCode;
    }

    function submitOrder(e){
      e.preventDefault();
      if(cart.length===0){alert("Warenkorb leer");return;}
      const name=document.getElementById("cust-name").value;
      const address=document.getElementById("cust-address").value;
      const phone=document.getElementById("cust-phone").value;
      const email=document.getElementById("cust-email").value;
      const lines=cart.map(it=>`${it.qty}x ${it.name}${it.size?" ("+it.size+")":""}`).join("%0A");
      const ship=document.getElementById("shipping-option").value;
      const body=`Bestellung:%0A${lines}%0A%0AKunde:%0A${name}%0A${address}%0A${phone}%0A${email}%0AVersand: ${ship}%0ARabatt: ${appliedDiscount?JSON.stringify(appliedDiscount):"â€”"}`;
      window.location.href=`mailto:kaiuwe.koenig@web.de?subject=Fanshop-Bestellung&body=${body}`;
    }

    function showToast(msg){
      const t=document.getElementById("toast");
      t.textContent=msg; t.style.display="block";
      clearTimeout(t._h); t._h=setTimeout(()=>t.style.display="none",2000);
    }

    renderCart();
  </script>
</body>
</html>
