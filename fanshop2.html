<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fanshop - HSG RÃ¼/Bau/KÃ¶</title>
<style>
:root{
  --brand:#ff00a0;
  --brand-dark:#cc0080;
  --bg:#f7f7f8;
  --card:#fff;
  --muted:#666;
  --success:#1b8f3a;
}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#111}
header{background:var(--brand);color:#fff;padding:0.9rem 1rem;display:flex;align-items:center;justify-content:center;position:relative}
header h1{margin:0;font-size:1.05rem;font-weight:700}
.menu-toggle{position:absolute;right:1rem;top:0.9rem;background:none;border:0;color:#fff;font-size:1.4rem;cursor:pointer}

main{max-width:1100px;margin:1rem auto;padding:0 1rem}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem}
@media(max-width:640px){ .products{grid-template-columns:1fr} }

.product{background:var(--card);border-radius:10px;padding:0.8rem;box-shadow:0 6px 18px rgba(0,0,0,0.06);text-align:center;display:flex;flex-direction:column;justify-content:space-between}
.product h3{margin:0.5rem 0;color:var(--brand);font-size:1.05rem}
.small{font-size:0.92rem;color:var(--muted)}
.price{font-weight:800;margin:0.4rem 0}

/* Carousel */
.carousel{position:relative;display:flex;align-items:center;justify-content:center;gap:0.6rem;margin-bottom:0.6rem;min-height:130px;overflow:hidden}
.carousel-track{display:flex;transition:transform .28s ease;touch-action:pan-y}
.carousel-slide{min-width:120px;display:flex;justify-content:center;align-items:center;padding:0.25rem}
.carousel-slide img{max-width:120px;border-radius:8px;cursor:pointer;display:block}
@media(min-width:800px){ .carousel-slide img{max-width:140px} }
@media(max-width:420px){ .carousel-slide img{max-width:46%;} .carousel{gap:0.35rem} }

.carousel-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.45);border:0;color:#fff;padding:6px 8px;border-radius:6px;cursor:pointer;z-index:2}
.carousel-btn.left{left:8px}
.carousel-btn.right{right:8px}
.dots{display:flex;gap:6px;justify-content:center;margin-top:6px}
.dot{width:8px;height:8px;border-radius:50%;background:#ddd;cursor:pointer}
.dot.active{background:var(--brand)}

.controls{display:flex;gap:0.5rem;justify-content:center;align-items:center;flex-wrap:wrap;margin-top:0.4rem}
select,input[type=number]{padding:0.45rem;border-radius:6px;border:1px solid #ddd}
button.btn{background:var(--brand);color:#fff;border:0;padding:0.55rem 0.85rem;border-radius:8px;cursor:pointer;font-weight:700}
button.btn:hover{background:var(--brand-dark)}
button.small-btn{padding:0.35rem 0.6rem;font-size:0.95rem}

/* cart wrap */
.cart-wrap{margin-top:1.25rem;display:grid;grid-template-columns:1fr 360px;gap:1rem}
@media(max-width:880px){ .cart-wrap{grid-template-columns:1fr} }

.cart{background:var(--card);padding:1rem;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
.cart h2{margin-top:0;color:var(--brand)}
.cart-list{list-style:none;padding:0;margin:0;max-height:420px;overflow:auto}
.cart-item{display:flex;gap:0.6rem;align-items:center;justify-content:space-between;padding:0.5rem 0;border-bottom:1px dashed #eee}
.cart-item .left{flex:1}
.cart-item small{color:var(--muted)}

.summary{background:#fafafa;padding:0.8rem;border-radius:8px;margin-top:0.6rem}
.summary .line{display:flex;justify-content:space-between;padding:0.25rem 0}
.summary strong{font-size:1.05rem}

form.order{background:var(--card);padding:1rem;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
form.order label{display:block;font-weight:600;margin-top:0.6rem}
form.order input, form.order textarea, form.order select{width:100%;padding:0.5rem;border-radius:6px;border:1px solid #ddd;margin-top:0.25rem}
form.order button{margin-top:0.8rem}

/* lightbox & toast */
.lightbox{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:2000;align-items:center;justify-content:center}
.lightbox img{max-width:94%;max-height:92%;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,0.6)}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:1.25rem;background:var(--success);color:#fff;padding:0.55rem 0.9rem;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.18);display:none;z-index:3000;font-weight:700}
</style>
</head>
<body>
<header>
  <button class="menu-toggle" aria-label="Menu">â˜°</button>
  <h1>HSG RÃ¼/Bau/KÃ¶ â€” Fanshop</h1>
</header>
<main>
<section>
<h2 class="small">Unsere Fanartikel</h2>
<div class="products" id="products">

<!-- Product 1: Fantrikot -->
<article class="product" data-sku="trikot">
  <div class="carousel" data-carousel>
    <button class="carousel-btn left" aria-label="Vorheriges">â—€</button>
    <div class="carousel-track">
      <div class="carousel-slide"><img src="img/Fantrikot1.png" alt="Fantrikot vorne" data-full="img/Fantrikot1.png"></div>
      <div class="carousel-slide"><img src="img/Fantrikot2.png" alt="Fantrikot hinten" data-full="img/Fantrikot2.png"></div>
    </div>
    <button class="carousel-btn right" aria-label="NÃ¤chstes">â–¶</button>
  </div>
  <div class="dots" aria-hidden="true"></div>
  <h3>HSG Fantrikot</h3>
  <p class="small">Original in Vereinsfarben</p>
  <p class="price"><strong>24,90 â‚¬</strong></p>
  <div class="controls">
    <select id="size-trikot"><option>S</option><option>M</option><option>L</option><option>XL</option></select>
    <input type="number" id="qty-trikot" min="1" value="1" style="width:80px">
    <button class="btn" type="button" onclick="addToCartFromUI('trikot','HSG Fantrikot',24.90,'size-trikot','qty-trikot')">In den Warenkorb</button>
  </div>
</article>

<!-- Product 2: Fanshirt -->
<article class="product" data-sku="fanshirt">
  <div class="carousel" data-carousel>
    <button class="carousel-btn left" aria-label="Vorheriges">â—€</button>
    <div class="carousel-track">
      <div class="carousel-slide"><img src="img/Fanshirt1.png" alt="Fanshirt vorne" data-full="img/Fanshirt1.png"></div>
      <div class="carousel-slide"><img src="img/Fanshirt2.png" alt="Fanshirt hinten" data-full="img/Fanshirt2.png"></div>
    </div>
    <button class="carousel-btn right" aria-label="NÃ¤chstes">â–¶</button>
  </div>
  <div class="dots" aria-hidden="true"></div>
  <h3>HSG Fanshirt</h3>
  <p class="small">Klassisches Shirt mit Vereinslogo</p>
  <p class="price"><strong>15,90 â‚¬</strong></p>
  <div class="controls">
    <select id="size-shirt"><option>S</option><option>M</option><option>L</option><option>XL</option></select>
    <input type="number" id="qty-shirt" min="1" value="1" style="width:80px">
    <button class="btn" type="button" onclick="addToCartFromUI('fanshirt','HSG Fanshirt',15.90,'size-shirt','qty-shirt')">In den Warenkorb</button>
  </div>
</article>

<!-- Product 3: Sweater -->
<article class="product" data-sku="sweater">
  <div class="carousel" data-carousel>
    <button class="carousel-btn left" aria-label="Vorheriges">â—€</button>
    <div class="carousel-track">
      <div class="carousel-slide"><img src="img/Sweater1.png" alt="Sweater vorne" data-full="img/Sweater1.png"></div>
      <div class="carousel-slide"><img src="img/Sweater2.png" alt="Sweater hinten" data-full="img/Sweater2.png"></div>
    </div>
    <button class="carousel-btn right" aria-label="NÃ¤chstes">â–¶</button>
  </div>
  <div class="dots" aria-hidden="true"></div>
  <h3>HSG Sweater</h3>
  <p class="small">Warmer Sweater mit Logo</p>
  <p class="price"><strong>35,90 â‚¬</strong></p>
  <div class="controls">
    <select id="size-sweater"><option>S</option><option>M</option><option>L</option><option>XL</option></select>
    <input type="number" id="qty-sweater" min="1" value="1" style="width:80px">
    <button class="btn" type="button" onclick="addToCartFromUI('sweater','HSG Sweater',35.90,'size-sweater','qty-sweater')">In den Warenkorb</button>
  </div>
</article>

<!-- Product 4: GÃ¼rteltasche -->
<article class="product" data-sku="guerteltasche">
  <div class="carousel" data-carousel>
    <button class="carousel-btn left" aria-label="Vorheriges">â—€</button>
    <div class="carousel-track">
      <div class="carousel-slide"><img src="img/Guerteltasche.png" alt="GÃ¼rteltasche" data-full="img/Guerteltasche.png" style="max-width:120px"></div>
    </div>
    <button class="carousel-btn right" aria-label="NÃ¤chstes">â–¶</button>
  </div>
  <div class="dots" aria-hidden="true"></div>
  <h3>Kempa GÃ¼rteltasche</h3>
  <p class="small">Praktische Bauchtasche im HSG-Style</p>
  <p class="price"><strong>19,90 â‚¬</strong></p>
  <div class="controls">
    <input type="number" id="qty-guerteltasche" min="1" value="1" style="width:80px">
    <button class="btn" type="button" onclick="addToCartFromUI('guerteltasche','Kempa GÃ¼rteltasche',19.90,null,'qty-guerteltasche')">In den Warenkorb</button>
  </div>
</article>

</div>
</section>

<!-- CART + ORDER -->
<section class="cart-wrap">
<div class="cart">
<h2>ðŸ›’ Dein Warenkorb</h2>
<ul id="cart-list" class="cart-list"></ul>
<div class="summary" id="summary">
<div class="line"><span class="small">Zwischensumme</span><span id="subtotal">0,00 â‚¬</span></div>
<div class="line"><span class="small">Versand</span><span id="shipping-line">0,00 â‚¬</span></div>
<div class="line"><strong>Gesamt</strong><strong id="grand-total">0,00 â‚¬</strong></div>
</div>
<div style="margin-top:0.6rem">
<label class="small">Versandoption:</label>
<select id="shipping-option" aria-label="Versand">
<option value="pickup">Abholung (kostenlos)</option>
<option value="dhl">Versand per DHL (+7,90 â‚¬)</option>
<option value="hermes">Versand per Hermes (+6,50 â‚¬)</option>
<option value="express">Express (+12,90 â‚¬)</option>
</select>
</div>
<!-- Admin-Rabattcodes -->
<div style="margin-top:0.8rem">
<button id="admin-discount-btn" class="btn small-btn" onclick="promptDiscount()">Rabattcode erstellen (Admin)</button>
</div>
</div>

<form class="order" id="order-form" onsubmit="submitOrder(event)">
<h3>Bestelldaten</h3>
<label for="cust-name">Name *</label>
<input id="cust-name" required>
<label for="cust-address">Adresse *</label>
<textarea id="cust-address" rows="3" required></textarea>
<label for="cust-phone">Telefon *</label>
<input id="cust-phone" required>
<label for="cust-email">E-Mail *</label>
<input id="cust-email" type="email" required>
<small class="muted">Die Bestellung wird per E-Mail an kaiuwe.koenig@web.de gesendet.</small>
<button class="btn" type="submit">Bestellung abschicken</button>
</form>
</section>

<!-- Lightbox & Toast -->
<div id="lightbox" class="lightbox" onclick="closeLightbox()"><img id="lightbox-img" src="" alt="Zoom"></div>
<div id="toast" class="toast">Artikel in den Warenkorb gelegt</div>

<script>
/* -------------------------
 Utilities & state
------------------------- */
function formatPriceEuro(value){ return value.toFixed(2).replace('.',',') + ' â‚¬'; }
const STORAGE_KEY = 'hsg_fanshop_cart_v3';
let cart = JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]');
let discountCodes = []; // {code, value}
const SHIPPING = {pickup:0,dhl:7.9,hermes:6.5,express:12.9};

document.addEventListener('DOMContentLoaded', ()=>{
  initCarousels();
  attachImageLightbox();
  renderCart();
  document.getElementById('shipping-option').addEventListener('change', renderCart);
});

/* -------------------------
 Carousel
------------------------- */
function initCarousels(){
  document.querySelectorAll('[data-carousel]').forEach(c=>{
    const track = c.querySelector('.carousel-track');
    const slides = Array.from(track.children);
    const leftBtn = c.querySelector('.carousel-btn.left');
    const rightBtn = c.querySelector('.carousel-btn.right');
    const dotsContainer = c.nextElementSibling;
    let index = 0;

    function update(){
      const slideWidth = slides[0].getBoundingClientRect().width;
      track.style.transform = `translateX(-${slideWidth*index}px)`;
      if(dotsContainer){
        Array.from(dotsContainer.children).forEach((d,i)=> d.classList.toggle('active', i===index));
      }
    }
    function prev(){ index = (index-1+slides.length)%slides.length; update();}
    function next(){ index = (index+1)%slides.length; update();}
    function goTo(i){ index=i%slides.length; update();}

    leftBtn.addEventListener('click',prev);
    rightBtn.addEventListener('click',next);
    if(dotsContainer && dotsContainer.children.length===0){
      slides.forEach((_,i)=>{
        const d=document.createElement('div'); d.className='dot'+(i===0?' active':'');
        d.addEventListener('click',()=>goTo(i));
        dotsContainer.appendChild(d);
      });
    }

    // touch support
    let startX=null,moved=false;
    track.addEventListener('pointerdown',e=>{startX=e.clientX;track.setPointerCapture(e.pointerId);});
    track.addEventListener('pointermove',e=>{if(startX===null) return;const dx=e.clientX-startX;if(Math.abs(dx)>30)moved=true;});
    track.addEventListener('pointerup',e=>{if(!moved){startX=null;moved=false;return;}const dx=e.clientX-startX;if(dx<-30)next();else if(dx>30)prev();startX=null;moved=false;});

    update(); window.addEventListener('resize',update);
  });
}

/* -------------------------
 Add to cart & persistence
------------------------- */
function addToCartFromUI(sku,name,price,sizeId,qtyId){
  const size = sizeId ? document.getElementById(sizeId).value : null;
  const qty = qtyId ? Math.max(1,parseInt(document.getElementById(qtyId).value)||1):1;
  addToCart(sku,name,price,size,qty);
}

function addToCart(sku,name,price,size,quantity){
  const existing=cart.find(i=>i.sku===sku&&(i.size||'')===(size||''));
  if(existing){ existing.quantity+=quantity; } else { cart.push({sku,name,price:Number(price),size:size||null,quantity:Number(quantity)});}
  saveCart(); renderCart(); showToast(`${name} wurde in den Warenkorb gelegt`);
}
function saveCart(){ localStorage.setItem(STORAGE_KEY,JSON.stringify(cart)); }
function removeItem(idx){ cart.splice(idx,1);saveCart();renderCart();}
function changeQty(idx,delta){ cart[idx].quantity=Math.max(1,cart[idx].quantity+delta);saveCart();renderCart();}
function setQty(idx,val){ cart[idx].quantity=Math.max(1,parseInt(val)||1);saveCart();renderCart();}

function renderCart(){
  const list=document.getElementById('cart-list'); list.innerHTML='';
  let subtotal=0;
  cart.forEach((it,idx)=>{ subtotal+=it.price*it.quantity;
    const li=document.createElement('li'); li.className='cart-item';
    li.innerHTML=`<div class="left"><div style="font-weight:700">${it.name}${it.size?' â€” '+it.size:''}</div><small>${formatPriceEuro(it.price)} x ${it.quantity} = ${formatPriceEuro(it.price*it.quantity)}</small></div>
    <div class="actions">
      <button class="remove" onclick="removeItem(${idx})" title="Entfernen">âœ–</button>
      <button class="btn small-btn" onclick="changeQty(${idx},-1)" title="Menge verringern">âˆ’</button>
      <input style="width:56px;padding:6px;border-radius:6px;border:1px solid #ddd;text-align:center" value="${it.quantity}" oninput="setQty(${idx}, this.value)" />
      <button class="btn small-btn" onclick="changeQty(${idx},1)" title="Menge erhÃ¶hen">+</button>
    </div>`;
    list.appendChild(li);
  });

  const shipOpt=document.getElementById('shipping-option').value;
  const shippingLine=(cart.length>0)?SHIPPING[shipOpt]||0:0;
  let grand=subtotal+shippingLine;

  // apply discount if any
  const appliedCode=localStorage.getItem('discountCode');
  if(appliedCode){
    const discount=discountCodes.find(dc=>dc.code===appliedCode);
    if(discount) grand-=discount.value;
  }

  document.getElementById('subtotal').textContent=formatPriceEuro(subtotal);
  document.getElementById('shipping-line').textContent=formatPriceEuro(shippingLine);
  document.getElementById('grand-total').textContent=formatPriceEuro(grand);
}

/* -------------------------
 Checkout
------------------------- */
function submitOrder(e){
  e.preventDefault();
  if(cart.length===0){ alert('Dein Warenkorb ist leer.'); return;}
  const name=document.getElementById('cust-name').value.trim();
  const address=document.getElementById('cust-address').value.trim();
  const phone=document.getElementById('cust-phone').value.trim();
  const email=document.getElementById('cust-email').value.trim();
  if(!name||!address||!phone||!email){ alert('Bitte fÃ¼lle alle Pflichtfelder aus.'); return;}

  const lines=cart.map(it=>`${it.quantity}x ${it.name}${it.size?' ('+it.size+')':''} â€” ${formatPriceEuro(it.price*it.quantity)}`);
  const subtotal=cart.reduce((s,i)=>s+i.price*i.quantity,0);
  const shipOpt=document.getElementById('shipping-option').value;
  const shippingLine=(cart.length>0)?SHIPPING[shipOpt]||0:0;
  let grand=subtotal+shippingLine;
  const appliedCode=localStorage.getItem('discountCode');
  if(appliedCode){
    const discount=discountCodes.find(dc=>dc.code===appliedCode);
    if(discount) grand-=discount.value;
  }

  let body=`Bestellung Fanshop HSG RÃ¼/Bau/KÃ¶\n\nArtikel:\n${lines.join('\n')}\n\nZwischensumme: ${formatPriceEuro(subtotal)}\nVersand: ${formatPriceEuro(shippingLine)}\nGesamt: ${formatPriceEuro(grand)}\n\nKundendaten:\nName: ${name}\nAdresse: ${address}\nTelefon: ${phone}\nE-Mail: ${email}\nVersandoption: ${shipOpt}${appliedCode?' (+ Rabattcode '+appliedCode+')':''}`;
  window.location.href=`mailto:kaiuwe.koenig@web.de?subject=Fanshop-Bestellung&body=${encodeURIComponent(body)}`;
}

/* -------------------------
 Lightbox
------------------------- */
function attachImageLightbox(){
  document.querySelectorAll('.product img').forEach(img=>{
    img.addEventListener('click',()=>{
      document.getElementById('lightbox-img').src=img.dataset.full||img.src;
      document.getElementById('lightbox').style.display='flex';
    });
  });
}
function closeLightbox(){ document.getElementById('lightbox').style.display='none'; document.getElementById('lightbox-img').src=''; }

/* -------------------------
 Toast
------------------------- */
function showToast(msg){
  const t=document.getElementById('toast'); t.textContent=msg; t.style.display='block';
  clearTimeout(t._hide); t._hide=setTimeout(()=>t.style.display='none',2200);
}

/* -------------------------
 Admin Discount Code
------------------------- */
function promptDiscount(){
  const pwd=prompt('Admin-Passwort eingeben:');
  if(pwd!=='hsgadmin'){ alert('Falsches Passwort'); return;}
  const amount=parseFloat(prompt('Rabattbetrag in â‚¬ eingeben:','5'));
  if(isNaN(amount)||amount<=0){ alert('UngÃ¼ltiger Betrag'); return;}
  const code=generateCode();
  discountCodes.push({code,value:amount});
  localStorage.setItem('discountCodes',JSON.stringify(discountCodes));
  alert(`Neuer Rabattcode: ${code} (${formatPriceEuro(amount)})`);
  const apply=confirm('Code direkt anwenden?');
  if(apply){ localStorage.setItem('discountCode',code); renderCart();}
}
function generateCode(){ return Array.from({length:3},()=>Math.random().toString(36).substring(2,6).toUpperCase()).join('-'); }
</script>
</body>
</html>
